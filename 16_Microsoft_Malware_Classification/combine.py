# combining the bigrams

import os
import pickle as pkl
from re import S
from scipy.sparse import lil_matrix
from scipy.sparse import vstack
from glob import glob 
from tqdm import tqdm

def putPickel(var,path):
    file = open(path,'wb')
    pkl.dump(var,file)
    file.close()

def getPickel(path):
    file = open(path,'rb')
    obj =  pkl.load(file)
    return obj

if __name__=='__main__':
    
    scratch_folder_resutls = "/scratch/sisodiya.bhoomeendra/results"
    path_id = [] 
    for paths in glob(scratch_folder_resutls+"/*"):
        idx = int(paths.split('/')[-1][7:].split('.')[0])
        path_id.append([ paths , idx ])
    s_paths = sorted(path_id,key=lambda a:a[1])
    print(s_paths)
    combine =  getPickel(s_paths[0][0])
    for path,id in tqdm(s_paths):
        if id == 0:
            continue
        else:
            temp  = getPickel(path)
            combine = vstack([combine,temp])
    print(combine.shape,type(combine))
    putPickel(combine,os.path.join("/scratch/sisodiya.bhoomeendra/uni_bi_gram.pkl"))
